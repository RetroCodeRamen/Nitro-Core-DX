package ui

import (
	"github.com/veandco/go-sdl2/sdl"
)

// Simple 8x8 bitmap font for rendering text
// Each character is 8x8 pixels, stored as 8 bytes (one per row)
var font8x8 = map[rune][8]uint8{
	'0': {0x3E, 0x63, 0x73, 0x7B, 0x6F, 0x67, 0x63, 0x3E},
	'1': {0x0C, 0x0E, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x3F},
	'2': {0x3E, 0x63, 0x60, 0x38, 0x0E, 0x03, 0x63, 0x7F},
	'3': {0x3E, 0x63, 0x60, 0x3C, 0x60, 0x60, 0x63, 0x3E},
	'4': {0x30, 0x38, 0x3C, 0x36, 0x33, 0x7F, 0x30, 0x30},
	'5': {0x7F, 0x03, 0x03, 0x3F, 0x60, 0x60, 0x63, 0x3E},
	'6': {0x3E, 0x63, 0x03, 0x3F, 0x63, 0x63, 0x63, 0x3E},
	'7': {0x7F, 0x63, 0x60, 0x30, 0x18, 0x0C, 0x0C, 0x0C},
	'8': {0x3E, 0x63, 0x63, 0x3E, 0x63, 0x63, 0x63, 0x3E},
	'9': {0x3E, 0x63, 0x63, 0x63, 0x7E, 0x60, 0x63, 0x3E},
	'A': {0x1C, 0x36, 0x63, 0x63, 0x7F, 0x63, 0x63, 0x63},
	'B': {0x3F, 0x66, 0x66, 0x3E, 0x66, 0x66, 0x66, 0x3F},
	'C': {0x3C, 0x66, 0x03, 0x03, 0x03, 0x03, 0x66, 0x3C},
	'D': {0x1F, 0x36, 0x66, 0x66, 0x66, 0x66, 0x36, 0x1F},
	'E': {0x7F, 0x03, 0x03, 0x3F, 0x03, 0x03, 0x03, 0x7F},
	'F': {0x7F, 0x03, 0x03, 0x3F, 0x03, 0x03, 0x03, 0x03},
	'G': {0x3C, 0x66, 0x03, 0x03, 0x73, 0x63, 0x66, 0x3C},
	'H': {0x63, 0x63, 0x63, 0x7F, 0x63, 0x63, 0x63, 0x63},
	'I': {0x3F, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x3F},
	'J': {0x78, 0x30, 0x30, 0x30, 0x30, 0x33, 0x33, 0x1E},
	'K': {0x67, 0x66, 0x36, 0x1E, 0x1E, 0x36, 0x66, 0x67},
	'L': {0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x7F},
	'M': {0x63, 0x77, 0x7F, 0x6B, 0x63, 0x63, 0x63, 0x63},
	'N': {0x63, 0x67, 0x6F, 0x7B, 0x73, 0x63, 0x63, 0x63},
	'O': {0x1C, 0x36, 0x63, 0x63, 0x63, 0x63, 0x36, 0x1C},
	'P': {0x3F, 0x66, 0x66, 0x66, 0x3E, 0x06, 0x06, 0x06},
	'Q': {0x1C, 0x36, 0x63, 0x63, 0x63, 0x6B, 0x36, 0x5C},
	'R': {0x3F, 0x66, 0x66, 0x66, 0x3E, 0x36, 0x66, 0x67},
	'S': {0x1E, 0x33, 0x07, 0x0E, 0x38, 0x70, 0x33, 0x1E},
	'T': {0x3F, 0x2D, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x1E},
	'U': {0x63, 0x63, 0x63, 0x63, 0x63, 0x63, 0x63, 0x3E},
	'V': {0x63, 0x63, 0x63, 0x63, 0x63, 0x36, 0x1C, 0x08},
	'W': {0x63, 0x63, 0x63, 0x6B, 0x7F, 0x77, 0x63, 0x63},
	'X': {0x63, 0x63, 0x36, 0x1C, 0x1C, 0x36, 0x63, 0x63},
	'Y': {0x33, 0x33, 0x33, 0x1E, 0x0C, 0x0C, 0x0C, 0x1E},
	'Z': {0x7F, 0x63, 0x31, 0x18, 0x0C, 0x46, 0x63, 0x7F},
	' ': {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	':': {0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x18, 0x18},
	'.': {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18},
	'/': {0x60, 0x30, 0x30, 0x18, 0x0C, 0x0C, 0x06, 0x06},
	'-': {0x00, 0x00, 0x00, 0x7F, 0x7F, 0x00, 0x00, 0x00},
}

// drawText draws text directly to the renderer as an overlay
func (u *UI) drawText(renderer *sdl.Renderer, text string, x, y int32, scale int, color sdl.Color) {
	charX := x
	for _, char := range text {
		if charX+int32(8*scale) > int32(320*u.scale) {
			break
		}
		if glyph, ok := font8x8[char]; ok {
			for row := 0; row < 8; row++ {
				if y+int32(row*scale) >= int32(200*u.scale) {
					break
				}
				bits := glyph[row]
				for col := 0; col < 8; col++ {
					if (bits>>(7-col))&1 != 0 {
						// Draw scaled pixel
						rect := &sdl.Rect{
							X: charX + int32(col*scale),
							Y: y + int32(row*scale),
							W: int32(scale),
							H: int32(scale),
						}
						renderer.SetDrawColor(color.R, color.G, color.B, color.A)
						renderer.FillRect(rect)
					}
				}
			}
		}
		charX += int32(8 * scale)
	}
}

